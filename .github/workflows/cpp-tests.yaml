name: C++ test

on:
  push:
  pull_request:

jobs:
  cpp-x64:
    name: "C++ tests (Linux-MacOS-Windows/x64)"
    strategy:
      fail-fast: false
      matrix:
        # Building for {g++, clang++}/Linux, clang++/MacOS, and msvc/Windows
        # both in Debug and Release
        os: [ubuntu-latest, macos-latest, windows-latest]
        compiler: [g++, clang++, msvc]
        build_type: [Debug, Release]
        exclude:
          - os: ubuntu-latest
            compiler: msvc
          - os: macos-latest
            compiler: g++
          - os: macos-latest
            compiler: msvc
          - os: windows-latest
            compiler: g++
          - os: windows-latest
            compiler: clang++
    runs-on: ubuntu-latest
    steps:
      - name: Test configurations
        run: echo "os:" ${{ matrix.os }} ", compiler:" ${{ matrix.compiler }} ", build_type:" ${{ matrix.build_type }}
        shell: bash
      - uses: ./.github/workflows/tests.yaml
        with:
          os: ${{ matrix.os }}
          ocompilers: ${{ matrix.compiler }}
          build_type: ${{ matrix.build_type }}

  # cpp-arm64:
  #   name: "C++ tests (gcc/Linux/ARM64, clang/MacOS/ARM64)"
  #   runs-on: ubuntu-latest
  #   strategy:
  #     fail-fast: false
  #     matrix:
  #       os: [ubuntu-latest, macos-latest, windows-latest]
  #   steps:
